---
leyout: post
title: tDiary-5.0.0 リリース
date: 2016-03-30 05:53:31 +0900
categories:
  - release
  - 5.0
---
### tDiary-5.0.0

tDiary 5.0.0 をリリースします。Ruby 2.0のサポート終了にともない、比較的影響の大きな非互換が発生したため、メジャーバージョンを5としました。

その非互換とはセキュアモード(secure mode)の廃止です。ですから、tdiary.confにて「@secure = true」としていない日記はこの非互換の対象ではありません。通常通りアップデートしても大丈夫です。セキュアモードを使った日記を運用している場合は、以下の注意を読んで対応して下さい。

Ruby 2.1以降では、tDiaryがセキュアモードを実現するのに使っていた機能がなくなったため、この非互換が発生しています。つまり、Ruby 2.0以前のバージョンを使っている場合には影響を受けません(ただしそのRubyは古くてサポートされていないので急いでアップデートすべきです)。他者に貸し出すため等の目的でセキュアモードで運用している日記を、Ruby 2.1以降のバージョンで動かす場合には、個々の日記がシステムに手出しをできないように、以下のような対策を打つべきでしょう(上から順に簡単な対策になっています):

* suexecやそれに類した環境でCGIをそれぞれのユーザ権限で動作させる
* jailやそれに類した環境でWebサーバをそれぞれのユーザ権限で動作させる
* Dockerやそれに類した環境でコンテナ自体を分離する
* 日記ごとに別のサーバを用意する

#### 本体(tdiary-core)の変更点

##### 機能追加・変更
* Ruby 2.0のEoLにともなうサポート終了
* セキュアモードの廃止
* HTTPSでの運用が可能になった
* masterブランチを直接Herokuへデプロイ可能になった (herokuブランチは廃止)
* categoryプラグインを軽量版に置き換え。旧版はcategory-legacyプラグインとして存続
* CSSの読み込み順位を変えて表示を高速化
* squeezeプラグインをcontribへ移動
* theme_onlineプラグインで利用するテーマをGitHub上のものに変更
* 出力するHTMLをHTML5に準拠

##### 開発者向け変更点
* jQueryを2.1にアップデート
* jQueryUIを1.11にアップデート

##### バグ修正
* エラー出力に非UTF-8文字列が含まれていても動作するように修正

#### contrib(tdiary-contrib)の変更点

##### 機能追加・変更
* セキュアモードの廃止
* HTTPSでの運用が可能になった
* squeezeプラグインをcoreから移動
* youtubeプラグインをレスポンシブ対応

##### バグ修正
* 小規模な修正がいくつか

